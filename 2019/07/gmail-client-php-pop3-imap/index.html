<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Writing a Gmail client on PHP (POP3 and IMAP) | Learn with Daniel - A learner diary</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon-128.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="A learner diary">
    
    <link rel="preload" href="/assets/css/0.styles.e0c1612b.css" as="style"><link rel="preload" href="/assets/js/app.5632ea00.js" as="script"><link rel="preload" href="/assets/js/3.9e1cc85f.js" as="script"><link rel="preload" href="/assets/js/26.4b88dd5e.js" as="script"><link rel="preload" href="/assets/js/22.2ffb8c95.js" as="script"><link rel="prefetch" href="/assets/js/10.ab7cb67b.js"><link rel="prefetch" href="/assets/js/11.5242956c.js"><link rel="prefetch" href="/assets/js/12.59c1b827.js"><link rel="prefetch" href="/assets/js/13.eb4c0cc0.js"><link rel="prefetch" href="/assets/js/14.cd6385da.js"><link rel="prefetch" href="/assets/js/15.f6ed5cf0.js"><link rel="prefetch" href="/assets/js/16.60e48bf7.js"><link rel="prefetch" href="/assets/js/17.6ade2139.js"><link rel="prefetch" href="/assets/js/18.f3523bb9.js"><link rel="prefetch" href="/assets/js/19.0cd9be83.js"><link rel="prefetch" href="/assets/js/20.74e5d0bb.js"><link rel="prefetch" href="/assets/js/21.057bc373.js"><link rel="prefetch" href="/assets/js/23.45611473.js"><link rel="prefetch" href="/assets/js/24.2c5aaad4.js"><link rel="prefetch" href="/assets/js/25.53994f14.js"><link rel="prefetch" href="/assets/js/27.33da5e65.js"><link rel="prefetch" href="/assets/js/28.e1bc1897.js"><link rel="prefetch" href="/assets/js/29.41a44f48.js"><link rel="prefetch" href="/assets/js/30.b52a01e3.js"><link rel="prefetch" href="/assets/js/31.32e50696.js"><link rel="prefetch" href="/assets/js/32.9870be67.js"><link rel="prefetch" href="/assets/js/33.6be9bedc.js"><link rel="prefetch" href="/assets/js/34.95333d7a.js"><link rel="prefetch" href="/assets/js/35.b90c291b.js"><link rel="prefetch" href="/assets/js/36.853d11aa.js"><link rel="prefetch" href="/assets/js/37.fe79cc5b.js"><link rel="prefetch" href="/assets/js/38.aef7ef02.js"><link rel="prefetch" href="/assets/js/39.dca7aa67.js"><link rel="prefetch" href="/assets/js/4.37520176.js"><link rel="prefetch" href="/assets/js/40.d659d938.js"><link rel="prefetch" href="/assets/js/41.83aeacc5.js"><link rel="prefetch" href="/assets/js/42.610c5aca.js"><link rel="prefetch" href="/assets/js/43.e9222b3a.js"><link rel="prefetch" href="/assets/js/44.9858f816.js"><link rel="prefetch" href="/assets/js/45.b0f0f5f2.js"><link rel="prefetch" href="/assets/js/46.492b33ea.js"><link rel="prefetch" href="/assets/js/47.07c3328b.js"><link rel="prefetch" href="/assets/js/48.b2d7476f.js"><link rel="prefetch" href="/assets/js/49.9fd583ed.js"><link rel="prefetch" href="/assets/js/5.b259d54e.js"><link rel="prefetch" href="/assets/js/50.9e6ef79d.js"><link rel="prefetch" href="/assets/js/51.8c3776f7.js"><link rel="prefetch" href="/assets/js/52.92a4b980.js"><link rel="prefetch" href="/assets/js/53.3e72d3bc.js"><link rel="prefetch" href="/assets/js/54.e1e107ff.js"><link rel="prefetch" href="/assets/js/55.418768d6.js"><link rel="prefetch" href="/assets/js/56.95ca3ac0.js"><link rel="prefetch" href="/assets/js/57.ea7fb933.js"><link rel="prefetch" href="/assets/js/58.40c5610c.js"><link rel="prefetch" href="/assets/js/59.5af9d54f.js"><link rel="prefetch" href="/assets/js/6.70c0bce3.js"><link rel="prefetch" href="/assets/js/60.0c66c22f.js"><link rel="prefetch" href="/assets/js/61.05b88817.js"><link rel="prefetch" href="/assets/js/62.483e5481.js"><link rel="prefetch" href="/assets/js/63.6ab28e82.js"><link rel="prefetch" href="/assets/js/7.8d26dacd.js"><link rel="prefetch" href="/assets/js/8.6beb7cbb.js"><link rel="prefetch" href="/assets/js/9.5015eb07.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.92df942c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e0c1612b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="dark:bg-gray-1000 bg-white dark:text-sepia text-gray-900" data-v-335698aa><header class="border-b-4 dark:border-green-700 border-primary" data-v-335698aa><div class="container mx-auto flex h-20 px-6 items-center"><a href="/" class="dark:text-green-700 text-primary text-3xl router-link-active">
            Learn With Daniel
        </a></div></header> <div class="container mx-auto px-6 md:px-16 py-8 max-w-screen-md" data-v-335698aa><div class="py-8 md:py-16" data-v-335698aa><div data-v-335698aa><span class="dark:bg-gray-800 bg-gray-100 px-3 py-1 mx-1 rounded-full uppercase text-xs font-medium dark:text-green-700 tracking-wider" data-v-335698aa>
                    PHP
                </span><span class="dark:bg-gray-800 bg-gray-100 px-3 py-1 mx-1 rounded-full uppercase text-xs font-medium dark:text-green-700 tracking-wider" data-v-335698aa>
                    POP3
                </span></div> <h1 class="dark:text-green-500 text-4xl md:text-6xl py-6" data-v-335698aa>Writing a Gmail client on PHP (POP3 and IMAP)</h1> <p class="author text-sm" data-v-335698aa>
                by <span class="text-base font-bold" data-v-335698aa>Daniel Loureiro</span>
                on <time class="mr-3" data-v-335698aa>Jul 17, 2019</time> <span class="reading-time text-xs uppercase py-4 block md:inline-block md:py-9" data-v-335698aa><vp-icon size="1.5em" name="clock-best" class="inline-block" data-v-335698aa></vp-icon>
                    5 min read
                </span></p></div> <div class="post-wrap text-xl leading-10 pb-8" data-v-335698aa><div class="content__default" data-v-335698aa><p>Let's create a Gmail email client using PHP's native IMAP library.
</p> <p>For this, you need the <code>php-imap</code> installed.</p> <p>Despite the name, the IMAP library works with POP3 too.</p> <hr> <h2 id="basic-code"><a href="#basic-code" class="header-anchor">#</a> Basic code</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// gmail-client.php</span>

<span class="token comment">/** Connect to GMail. */</span>
<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'daniel@gmail.com'</span><span class="token punctuation">;</span>
<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'34LWD12'</span><span class="token punctuation">;</span>
<span class="token variable">$str_conn</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'{imap.gmail.com:993/ssl/novalidate-cert}INBOX'</span><span class="token punctuation">;</span>
<span class="token variable">$conn</span>     <span class="token operator">=</span> <span class="token function">imap_open</span><span class="token punctuation">(</span><span class="token variable">$str_conn</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/** Retrieve and display all messages. */</span>
<span class="token variable">$msgs</span> <span class="token operator">=</span> <span class="token function">imap_fetch_overview</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'1:*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$msgs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="return-example"><a href="#return-example" class="header-anchor">#</a> Return Example</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">Array</span>
<span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> stdClass <span class="token keyword type-declaration">Object</span>
    <span class="token punctuation">(</span>
        <span class="token punctuation">[</span>subject<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> Test
        <span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> John Snow <span class="token operator">&lt;</span>john@snow<span class="token operator">.</span>com<span class="token operator">&gt;</span>
        <span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> Daniel Loureiro <span class="token operator">&lt;</span>daniel@learnwithdaniel<span class="token operator">.</span>com<span class="token operator">&gt;</span>
        <span class="token punctuation">[</span>date<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> Fri<span class="token punctuation">,</span> <span class="token number">12</span> Jul <span class="token number">2019</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">12</span> <span class="token operator">-</span><span class="token number">0400</span>
        <span class="token punctuation">[</span>message_id<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>CABgjj39<span class="token operator">-</span>BMb_NPaCPmh<span class="token operator">+</span>ds7zsOzTCrJfRotaB4CZ1Yuv<span class="token operator">=</span>mLxkA@mail<span class="token operator">.</span>gmail<span class="token operator">.</span>com<span class="token operator">&gt;</span>
        <span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">4691</span>
        <span class="token punctuation">[</span>uid<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">3</span>
        <span class="token punctuation">[</span>msgno<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1</span>
        <span class="token punctuation">[</span>recent<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
        <span class="token punctuation">[</span>flagged<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
        <span class="token punctuation">[</span>answered<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1</span>
        <span class="token punctuation">[</span>deleted<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
        <span class="token punctuation">[</span>seen<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1</span>
        <span class="token punctuation">[</span>draft<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
        <span class="token punctuation">[</span>udate<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1562951089</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block success"><p>That's it!</p></div> <hr> <h2 id="pop3"><a href="#pop3" class="header-anchor">#</a> POP3</h2> <p>The previous example connects through IMAP. If you prefer POP3, use this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$str_conn</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'{pop.gmail.com:995/pop3/ssl/novalidate-cert}INBOX'</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h3 id="credentials"><a href="#credentials" class="header-anchor">#</a> Credentials</h3> <ul><li><strong>Username:</strong> Your email.
Ex: &quot;<em>daniel@gmail.com</em>&quot;. It can have a <strong>custom domain</strong>, like &quot;<em>daniel@learwithdaniel.com</em>&quot;.</li> <li><strong>Password:</strong> Your account password.
For 2-step verification accounts, you can use an &quot;<em><strong>app password</strong></em>&quot;. These are extra passwords to access your account. With them, you don't need to share your actual password with your apps. For each app, you create a new &quot;app password&quot;. This is only available if &quot;2-step&quot; is enabled.</li></ul> <h3 id="msgno"><a href="#msgno" class="header-anchor">#</a> <code>msgno</code></h3> <p>Each message has a <code>msgno</code>, which is a sequential number. The very first message is <code>1</code>. This number is unique for your mailbox. Even if you delete a message, its <code>msgno</code> won't be reused.</p> <p>The <code>msgno</code> is used in many commands.</p> <hr> <h2 id="troubleshooting"><a href="#troubleshooting" class="header-anchor">#</a> Troubleshooting</h2> <p>If you get an &quot;invalid credentials&quot; error, you may have to enable the &quot;Allow Less Secure Apps&quot; option: <a href="https://myaccount.google.com/lesssecureapps" target="_blank" rel="noopener noreferrer">https://myaccount.google.com/lesssecureapps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>If you get this email, you need to click on it and authorize access:
<img src="/assets/img/gmail-alert.c3d154fd.png" alt="Gmail blocked access"></p></li> <li><p>Then, enable &quot;Less Secure Apps&quot; (or just use an &quot;app password&quot;):
<img src="/assets/img/gmail-allow-less.f21b4baa.png" alt="Gmail less secure apps option"></p></li></ol> <hr> <h2 id="retrieving-emails"><a href="#retrieving-emails" class="header-anchor">#</a> Retrieving emails</h2> <p>As we saw previously, that's how we get the messages:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// gmail-client.php</span>
<span class="token variable">$msgs</span> <span class="token operator">=</span> <span class="token function">imap_fetch_overview</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token variable">$range</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>$range</code> format is: <code>{msgno_from}:{msgno_to}</code>. The <code>msgno_from</code> and <code>msgno_to</code> are included in the response.</p> <p><strong>Range examples:</strong></p> <ul><li><strong>All messages:</strong> '1:*'</li> <li><strong>Just message #3:</strong> '3'</li> <li><strong>Message #3 and beyond (3,4,5,…):</strong> '3:*';</li></ul> <p>Use the range argument to create savepoints, i.e. if you want to download <strong>only the new messages</strong> and not the whole inbox each time your app syncs with Gmail. To create savepoints, download all messages (<code>1:*</code>) on the first time and save the last message number (&quot;msgno&quot;), ex. <code>5</code>. Next time, you check from that message and beyond (<code>6:*</code>).</p> <h2 id="display-name-from-to"><a href="#display-name-from-to" class="header-anchor">#</a> Display Name (From/To)</h2> <p>The &quot;From&quot; and &quot;To&quot; fields support a display name in addition to the email address:</p> <ul><li><strong>Email address only:</strong> <code>john@snow.com</code></li> <li><strong>Email address with Display name:</strong> <code>John Snow &lt;john@snow.com&gt;</code></li></ul> <h2 id="closing-the-connection"><a href="#closing-the-connection" class="header-anchor">#</a> Closing the connection</h2> <p>You should close the email connection after using it, which is usually at the end of your script.</p> <p>If you forget to close, PHP will automatically close it for you when the script ends, but it is a good idea to explicitly close it with:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">imap_close</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h2> <p>To get an array with past errors, use:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$errors</span> <span class="token operator">=</span> <span class="token function">imap_errors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Return example:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'[TRYCREATE] No folder {imap.gmail.com} (Failure)'</span><span class="token punctuation">]</span>
</code></pre></div><p>To get only the last error, use <code>imap_last_error()</code>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>If you don't retrieve errors by calling these functions, then all errors and warnings will be thrown when the connection gets closed.</p></div> <h2 id="replying-to-an-email"><a href="#replying-to-an-email" class="header-anchor">#</a> Replying to an email</h2> <p>Each message has a <code>message_id</code>, which is a universal unique identifier. Do not confuse with <code>msgno</code>, which is a local id, valid only for your inbox.</p> <p>To reply to messages, you need to set 2 things:</p> <ul><li><strong>Headers:</strong> Send the <code>message_id</code> of the message you are replying to in two header items: <code>In-Reply-To</code> and <code>References</code>;</li> <li><strong>Subject:</strong> The subject should be postfixed with the same subject as the original message. Example of valid reply subjects: <code>{$subject}</code> or <code>Re: {$subject}</code> or <code>Reply to {$subject}</code>. It actually doesn't matter if you prefix with something (like &quot;Re:&quot;) or not, the only rule is that you need to end the subject with the original copy;</li></ul> <h2 id="example-of-a-replied-message"><a href="#example-of-a-replied-message" class="header-anchor">#</a> Example of a replied message</h2> <p>If you are curious of how a replied message looks like when retrieving it:</p> <div class="language-php extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-php"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> stdClass <span class="token keyword type-declaration">Object</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>subject<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token argument-name">Re</span><span class="token punctuation">:</span> Test
    <span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> john@snow<span class="token operator">.</span>com
    <span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> Daniel Loureiro <span class="token operator">&lt;</span>daniel@learnwithdaniel<span class="token operator">.</span>com<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>date<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> Fri<span class="token punctuation">,</span> <span class="token number">12</span> Jul <span class="token number">2019</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">12</span> <span class="token operator">-</span><span class="token number">0400</span>
    <span class="token punctuation">[</span>message_id<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token constant">A0C26432</span><span class="token operator">-</span><span class="token constant">DD82</span><span class="token operator">-</span><span class="token number">411</span>A<span class="token operator">-</span><span class="token constant">AD61</span><span class="token operator">-</span><span class="token number">2</span>FB12E65C4D1@learnwithdaniel<span class="token operator">.</span>com<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>references<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>CABgjj39<span class="token operator">-</span>BMb_NPaCPmh<span class="token operator">+</span>ds7zsOzTCrJfRotaB4CZ1Yuv<span class="token operator">=</span>mLxkA@mail<span class="token operator">.</span>gmail<span class="token operator">.</span>com<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>in_reply_to<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>CABgjj39<span class="token operator">-</span>BMb_NPaCPmh<span class="token operator">+</span>ds7zsOzTCrJfRotaB4CZ1Yuv<span class="token operator">=</span>mLxkA@mail<span class="token operator">.</span>gmail<span class="token operator">.</span>com<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">4691</span>
    <span class="token punctuation">[</span>uid<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">3</span>
    <span class="token punctuation">[</span>msgno<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">2</span>
    <span class="token punctuation">[</span>recent<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">[</span>flagged<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">[</span>answered<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1</span>
    <span class="token punctuation">[</span>deleted<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">[</span>seen<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1</span>
    <span class="token punctuation">[</span>draft<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">0</span>
    <span class="token punctuation">[</span>udate<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token number">1562951089</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Notice <code>subject</code>, <code>references</code> and the <code>in_reply_to</code> fields.</p> <h2 id="which-email-address-you-should-reply-to"><a href="#which-email-address-you-should-reply-to" class="header-anchor">#</a> Which email address you should reply to?</h2> <p>You can reply to the email address specified in the &quot;From&quot; field, but if the sender has set a &quot;reply-to&quot;, your message will go the <strong>wrong place</strong>.</p> <p>To reply properly, you should get the headers with <code>imap_headerinfo($hnd, $msgno)</code> and use the <code>reply_toaddress</code> property (a string). Alternatively, you can use the <code>reply_to</code> property, which returns the email parsed as domain, account and display_name.</p> <p>It is safe to always use the &quot;reply_toaddress&quot; property (or the &quot;reply_to&quot;) even if the sender hasn't set a reply-to. In these cases, &quot;reply_toaddress&quot; will return the same value as &quot;from&quot;.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$headers</span> <span class="token operator">=</span> <span class="token function">imap_headerinfo</span><span class="token punctuation">(</span><span class="token variable">$hnd</span><span class="token punctuation">,</span> <span class="token variable">$msgno</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$reply_addr</span> <span class="token operator">=</span> <span class="token variable">$headers</span><span class="token operator">-&gt;</span><span class="token property">reply_toaddress</span><span class="token punctuation">;</span>
</code></pre></div></div></div> <hr class="my-12" data-v-335698aa> <div data-v-335698aa><h2 class="text-xl md:text-3xl pb-10 text-center" data-v-335698aa>Comments</h2> <!----></div></div> <footer class="py-4 bg-gray-800" data-v-335698aa><p class="text-center text-gray-600 text-xs">Copyright 2022 - Daniel Loureiro</p></footer></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/assets/js/app.5632ea00.js" defer></script><script src="/assets/js/3.9e1cc85f.js" defer></script><script src="/assets/js/26.4b88dd5e.js" defer></script><script src="/assets/js/22.2ffb8c95.js" defer></script>
  </body>
</html>
