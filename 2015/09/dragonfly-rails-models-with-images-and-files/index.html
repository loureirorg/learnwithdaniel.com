<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dragonfly gem: images and files in Rails models (Paperclip alternative) | Learn with Daniel - A learner diary</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon-128.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="A learner diary">
    
    <link rel="preload" href="/assets/css/0.styles.e0c1612b.css" as="style"><link rel="preload" href="/assets/js/app.5632ea00.js" as="script"><link rel="preload" href="/assets/js/3.9e1cc85f.js" as="script"><link rel="preload" href="/assets/js/17.6ade2139.js" as="script"><link rel="preload" href="/assets/js/22.2ffb8c95.js" as="script"><link rel="prefetch" href="/assets/js/10.ab7cb67b.js"><link rel="prefetch" href="/assets/js/11.5242956c.js"><link rel="prefetch" href="/assets/js/12.59c1b827.js"><link rel="prefetch" href="/assets/js/13.eb4c0cc0.js"><link rel="prefetch" href="/assets/js/14.cd6385da.js"><link rel="prefetch" href="/assets/js/15.f6ed5cf0.js"><link rel="prefetch" href="/assets/js/16.60e48bf7.js"><link rel="prefetch" href="/assets/js/18.f3523bb9.js"><link rel="prefetch" href="/assets/js/19.0cd9be83.js"><link rel="prefetch" href="/assets/js/20.74e5d0bb.js"><link rel="prefetch" href="/assets/js/21.057bc373.js"><link rel="prefetch" href="/assets/js/23.45611473.js"><link rel="prefetch" href="/assets/js/24.2c5aaad4.js"><link rel="prefetch" href="/assets/js/25.53994f14.js"><link rel="prefetch" href="/assets/js/26.4b88dd5e.js"><link rel="prefetch" href="/assets/js/27.33da5e65.js"><link rel="prefetch" href="/assets/js/28.e1bc1897.js"><link rel="prefetch" href="/assets/js/29.41a44f48.js"><link rel="prefetch" href="/assets/js/30.b52a01e3.js"><link rel="prefetch" href="/assets/js/31.32e50696.js"><link rel="prefetch" href="/assets/js/32.9870be67.js"><link rel="prefetch" href="/assets/js/33.6be9bedc.js"><link rel="prefetch" href="/assets/js/34.95333d7a.js"><link rel="prefetch" href="/assets/js/35.b90c291b.js"><link rel="prefetch" href="/assets/js/36.853d11aa.js"><link rel="prefetch" href="/assets/js/37.fe79cc5b.js"><link rel="prefetch" href="/assets/js/38.aef7ef02.js"><link rel="prefetch" href="/assets/js/39.dca7aa67.js"><link rel="prefetch" href="/assets/js/4.37520176.js"><link rel="prefetch" href="/assets/js/40.d659d938.js"><link rel="prefetch" href="/assets/js/41.83aeacc5.js"><link rel="prefetch" href="/assets/js/42.610c5aca.js"><link rel="prefetch" href="/assets/js/43.e9222b3a.js"><link rel="prefetch" href="/assets/js/44.9858f816.js"><link rel="prefetch" href="/assets/js/45.b0f0f5f2.js"><link rel="prefetch" href="/assets/js/46.492b33ea.js"><link rel="prefetch" href="/assets/js/47.07c3328b.js"><link rel="prefetch" href="/assets/js/48.b2d7476f.js"><link rel="prefetch" href="/assets/js/49.9fd583ed.js"><link rel="prefetch" href="/assets/js/5.b259d54e.js"><link rel="prefetch" href="/assets/js/50.9e6ef79d.js"><link rel="prefetch" href="/assets/js/51.8c3776f7.js"><link rel="prefetch" href="/assets/js/52.92a4b980.js"><link rel="prefetch" href="/assets/js/53.3e72d3bc.js"><link rel="prefetch" href="/assets/js/54.e1e107ff.js"><link rel="prefetch" href="/assets/js/55.418768d6.js"><link rel="prefetch" href="/assets/js/56.95ca3ac0.js"><link rel="prefetch" href="/assets/js/57.ea7fb933.js"><link rel="prefetch" href="/assets/js/58.40c5610c.js"><link rel="prefetch" href="/assets/js/59.5af9d54f.js"><link rel="prefetch" href="/assets/js/6.70c0bce3.js"><link rel="prefetch" href="/assets/js/60.0c66c22f.js"><link rel="prefetch" href="/assets/js/61.05b88817.js"><link rel="prefetch" href="/assets/js/62.483e5481.js"><link rel="prefetch" href="/assets/js/63.6ab28e82.js"><link rel="prefetch" href="/assets/js/7.8d26dacd.js"><link rel="prefetch" href="/assets/js/8.6beb7cbb.js"><link rel="prefetch" href="/assets/js/9.5015eb07.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.92df942c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e0c1612b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="dark:bg-gray-1000 bg-white dark:text-sepia text-gray-900" data-v-335698aa><header class="border-b-4 dark:border-green-700 border-primary" data-v-335698aa><div class="container mx-auto flex h-20 px-6 items-center"><a href="/" class="dark:text-green-700 text-primary text-3xl router-link-active">
            Learn With Daniel
        </a></div></header> <div class="container mx-auto px-6 md:px-16 py-8 max-w-screen-md" data-v-335698aa><div class="py-8 md:py-16" data-v-335698aa><div data-v-335698aa><span class="dark:bg-gray-800 bg-gray-100 px-3 py-1 mx-1 rounded-full uppercase text-xs font-medium dark:text-green-700 tracking-wider" data-v-335698aa>
                    Rails
                </span><span class="dark:bg-gray-800 bg-gray-100 px-3 py-1 mx-1 rounded-full uppercase text-xs font-medium dark:text-green-700 tracking-wider" data-v-335698aa>
                    Ruby
                </span><span class="dark:bg-gray-800 bg-gray-100 px-3 py-1 mx-1 rounded-full uppercase text-xs font-medium dark:text-green-700 tracking-wider" data-v-335698aa>
                    Gem
                </span></div> <h1 class="dark:text-green-500 text-4xl md:text-6xl py-6" data-v-335698aa>Dragonfly gem: images and files in Rails models (Paperclip alternative)</h1> <p class="author text-sm" data-v-335698aa>
                by <span class="text-base font-bold" data-v-335698aa>Daniel Loureiro</span>
                on <time class="mr-3" data-v-335698aa>Sep 27, 2015</time> <span class="reading-time text-xs uppercase py-4 block md:inline-block md:py-9" data-v-335698aa><vp-icon size="1.5em" name="clock-best" class="inline-block" data-v-335698aa></vp-icon>
                    7 min read
                </span></p></div> <div class="post-wrap text-xl leading-10 pb-8" data-v-335698aa><div class="content__default" data-v-335698aa><p>Let's say you want to add a <strong>picture field</strong> to your <strong>product model</strong>. How do you do it?</p> <p>Unfortunately, Rails' Active Record doesn't provide a native way to work with binary fields, like pictures. We can easily add a string field, but we can't add a file field.
</p> <p>Dragonfly is a gem that extends ActiveRecord, allowing to have binary fields, like videos, files, or... pictures. It's a good, or even better, alternative to the famous Paperclip gem.</p> <hr> <h2 id="before-we-start"><a href="#before-we-start" class="header-anchor">#</a> Before we start</h2> <p>Let's create an example app with these commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>rails new test_df
<span class="token builtin class-name">cd</span> test_df
rails g scaffold product title
rake db:migrate
rails s
</code></pre></div><h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <h3 id="_1-declare-dragonfly-gem-on-gemfile"><a href="#_1-declare-dragonfly-gem-on-gemfile" class="header-anchor">#</a> 1. Declare DragonFly gem on Gemfile</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># Gemfile</span>
gem <span class="token string">'dragonfly'</span>
</code></pre></div><h3 id="_2-install-it"><a href="#_2-install-it" class="header-anchor">#</a> 2. Install it</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>bundle <span class="token function">install</span>
</code></pre></div><h3 id="_3-generate-the-initializer-file"><a href="#_3-generate-the-initializer-file" class="header-anchor">#</a> 3. Generate the initializer file</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>rails g dragonfly
</code></pre></div><p>This command generates a <code>config/initializers/dragonfly.rb</code> file, which can be used to configure DragonFly's core settings.</p> <h2 id="creating-an-image-field"><a href="#creating-an-image-field" class="header-anchor">#</a> Creating an image field</h2> <p>To add a normal string field like <code>color</code>, we create a migration like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>rails g migration add_field_to_product color
</code></pre></div><p>That's how we create a <code>color</code> string field. To create a Dragonfly field, you need to add an <code>_uid</code> at the end of the name. So, in this example, the name would be <code>color_uid</code>. If the name is <code>photo</code>, that would be <code>photo_uid</code>.</p> <p>Let's use <code>image</code> as the field name:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>rails g migration add_field_to_product image_uid
</code></pre></div><p>Commit the changes with <code>rake db:migrate</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>rake db:migrate
</code></pre></div><p>Now open the <code>product</code> model and let Rails know this field isn't a string, but a file:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># app/model/product.rb</span>
dragonfly_accessor <span class="token symbol">:image</span>
</code></pre></div><h2 id="saving-a-file-to-a-record"><a href="#saving-a-file-to-a-record" class="header-anchor">#</a> Saving a file to a record</h2> <h3 id="_1-for-our-test-save-this-image-in-your-images-folder-as-1-jpg"><a href="#_1-for-our-test-save-this-image-in-your-images-folder-as-1-jpg" class="header-anchor">#</a> 1. For our test, save this image in your <code>Images</code> folder as <code>1.jpg</code></h3> <p><img src="/assets/img/1-300x225.795caeab.jpg" alt="Oranges"></p> <h3 id="_2-open-the-rails-console"><a href="#_2-open-the-rails-console" class="header-anchor">#</a> 2. Open the rails console</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>rails c
</code></pre></div><h3 id="_3-load-the-image-file-get-a-record-put-the-image-on-it-and-save-it"><a href="#_3-load-the-image-file-get-a-record-put-the-image-on-it-and-save-it" class="header-anchor">#</a> 3. Load the image file, get a record, put the image on it, and save it</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token operator">&gt;</span> i <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'../../Images/1.jpg'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> p <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>last
<span class="token operator">&gt;</span> p<span class="token punctuation">.</span>image <span class="token operator">=</span> i
<span class="token operator">&gt;</span> p<span class="token punctuation">.</span>save<span class="token operator">!</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>We are using <code>../../Images</code>, because my project is at <code>~/projects/test-dragonfly</code>, i.e., 2 folders from <code>~/Images</code>. Change it at your will.</p></div> <h3 id="_4-close-the-console-and-re-open-it-again-to-make-sure-the-image-has-been-saved"><a href="#_4-close-the-console-and-re-open-it-again-to-make-sure-the-image-has-been-saved" class="header-anchor">#</a> 4. Close the console and re-open it again to make sure the image has been saved</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token operator">&gt;</span> quit

rails c

<span class="token operator">&gt;</span> p <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>last
<span class="token operator">&gt;</span> p<span class="token punctuation">.</span>image
<span class="token comment"># =&gt; &lt;Dragonfly Attachment uid=&quot;2015/09/26/4ad07k6hin_1.jpg&quot;, app=:default&gt;</span>
</code></pre></div><p>If <code>p.image</code> isn't nil, it has been saved.</p> <h2 id="retrieving"><a href="#retrieving" class="header-anchor">#</a> Retrieving</h2> <h3 id="_1-to-get-the-file-path-use-the-url-method"><a href="#_1-to-get-the-file-path-use-the-url-method" class="header-anchor">#</a> 1. To get the file path, use the <code>url</code> method</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token operator">&gt;</span> p<span class="token punctuation">.</span>image<span class="token punctuation">.</span>url
<span class="token comment"># =&gt; &quot;/media/W1siZiIsIjIwMTUvMDkvMjYvNGFkMDdrNmhpbl8xLmpwZyJdXQ?sha=0d7af674c4891620&quot;</span>
</code></pre></div><h3 id="_2-copy-and-paste-the-result-on-the-browser-and-you-will-see-the-file"><a href="#_2-copy-and-paste-the-result-on-the-browser-and-you-will-see-the-file" class="header-anchor">#</a> 2. Copy and paste the result on the browser and you will see the file</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>http://localhost:3000/media/W1siZiIsIjIwMTUvMDkvMjYvNGFkMDdrNmhpbl8xLmpwZyJdXQ?sha<span class="token operator">=</span>0d7af674c4891620
</code></pre></div><h3 id="_3-for-images-we-can-use-the-thumb-method-it-generates-a-new-version-with-different-geometries"><a href="#_3-for-images-we-can-use-the-thumb-method-it-generates-a-new-version-with-different-geometries" class="header-anchor">#</a> 3. For images, we can use the <code>thumb</code> method. It generates a new version with different geometries</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token operator">&gt;</span> p<span class="token punctuation">.</span>image<span class="token punctuation">.</span>thumb<span class="token punctuation">(</span><span class="token string">'80x60'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>url
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">&quot;/media/W1siZiIsIjIwMTUvMDkvMjcvOGNiNHFmbTU0M18xLmpwZyJdLFsicCIsInRodW1iIiwiODB4NjAiXV0?sha=1931e3387c6b54f5&quot;</span>
</code></pre></div><h3 id="_4-copy-and-paste-the-result-on-the-browser-and-see-the-same-image-with-the-new-dimensions"><a href="#_4-copy-and-paste-the-result-on-the-browser-and-see-the-same-image-with-the-new-dimensions" class="header-anchor">#</a> 4. Copy and paste the result on the browser and see the same image with the new dimensions</h3> <hr> <h2 id="dragonfly-is-on-the-fly"><a href="#dragonfly-is-on-the-fly" class="header-anchor">#</a> Dragonfly is on-the-fly</h2> <p>In the rails server window, we can see the logs showing that DragonFly is generating the file on the fly:</p> <p><img src="/assets/img/lwd-dragonfly-server-1.25b18edb.png" alt="Rails server logs"></p> <p>Whenever someone loads the thumb image on a browser, Dragonfly gets the original image and converts it, generating a new image.</p> <p>To see this process happening, just reload the image on the browser and check the logs.</p> <p>That's why DragonFly has this name – it's on-the-fly, like a Dragonfly 😃</p> <hr> <h2 id="displaying-on-index-html-and-show-html"><a href="#displaying-on-index-html-and-show-html" class="header-anchor">#</a> Displaying on <code>index.html</code> and <code>show.html</code></h2> <p>Now, let's show these images as thumbs in our product index page.</p> <h3 id="_1-open-index-html-erb-and-create-a-thumb-column"><a href="#_1-open-index-html-erb-and-create-a-thumb-column" class="header-anchor">#</a> 1. Open <code>index.html.erb</code> and create a <code>thumb</code> column</h3> <p>Use <code>image_tag()</code> to generate an HTML image tag and the <code>thumb()</code> method to generate a smaller version of the image.</p> <p>Simplified example:</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token comment">&lt;!-- apps/views/products/index.html.erb --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>Thumb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
  <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span> <span class="token variable">@products</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>product<span class="token operator">|</span> <span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> product<span class="token punctuation">.</span>name <span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> image_tag product<span class="token punctuation">.</span>image<span class="token punctuation">.</span>thumb<span class="token punctuation">(</span><span class="token string">'80x60'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>url <span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
  <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span> <span class="token keyword">end</span> <span class="token delimiter punctuation">%&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Result:
<img src="data:image/png;base64,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" alt="Product list on browser"></p> <h3 id="_2-do-the-same-for-show-html-erb"><a href="#_2-do-the-same-for-show-html-erb" class="header-anchor">#</a> 2. Do the same for <code>show.html.erb</code></h3> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token comment">&lt;!-- apps/views/products/show.html.erb --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>Image:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
  <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> <span class="token variable">@product</span><span class="token punctuation">.</span>image<span class="token punctuation">.</span>url <span class="token delimiter punctuation">%&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_3-check-if-the-image-exists"><a href="#_3-check-if-the-image-exists" class="header-anchor">#</a> 3. Check if the image exists</h3> <p>If you run the above code you are going to get an exception. That's because you have some records without any image attached, and you're calling <code>thumb</code>/<code>url</code> methods from a <code>nil</code> value.</p> <p>To check if the field has an attached file or not, use Rail's core <code>nil?</code> method or use the <code>_stored?</code> method:</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token comment">&lt;!-- apps/views/products/show.html.erb --&gt;</span>
<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> product<span class="token punctuation">.</span>image_stored<span class="token operator">?</span> <span class="token operator">?</span> image_tag<span class="token punctuation">(</span>product<span class="token punctuation">.</span>image<span class="token punctuation">.</span>thumb<span class="token punctuation">(</span><span class="token string">'80x60'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span> <span class="token delimiter punctuation">%&gt;</span></span>
</code></pre></div><p>OR</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token comment">&lt;!-- apps/views/products/show.html.erb --&gt;</span>
<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> product<span class="token punctuation">.</span>image<span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span> <span class="token operator">?</span> image_tag<span class="token punctuation">(</span>product<span class="token punctuation">.</span>image<span class="token punctuation">.</span>thumb<span class="token punctuation">(</span><span class="token string">'80x60'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span> <span class="token delimiter punctuation">%&gt;</span></span>
</code></pre></div><h2 id="using-it-on-forms"><a href="#using-it-on-forms" class="header-anchor">#</a> Using it on forms</h2> <p>We've added images using the console. But how to save the image through a form?</p> <p>With DragonFly, we can do it in the same way that we would do with a normal field.</p> <h3 id="_1-open-form-html-erb-create-a-new-html-field-with-the-corresponding-name-and-use-the-file-field-method-to-generate-a-html-file-field"><a href="#_1-open-form-html-erb-create-a-new-html-field-with-the-corresponding-name-and-use-the-file-field-method-to-generate-a-html-file-field" class="header-anchor">#</a> 1. Open <code>_form.html.erb</code>, create a new HTML field with the corresponding name, and use the <code>file_field</code> method to generate a HTML file field</h3> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token comment">&lt;!-- app/views/products/_form.html.erb --&gt;</span>
<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> form_for<span class="token punctuation">(</span><span class="token variable">@product</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>f<span class="token operator">|</span> <span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> f<span class="token punctuation">.</span>label <span class="token symbol">:title</span> <span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> f<span class="token punctuation">.</span>text_field <span class="token symbol">:title</span> <span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>field<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> f<span class="token punctuation">.</span>label <span class="token symbol">:image</span> <span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> f<span class="token punctuation">.</span>file_field <span class="token symbol">:image</span> <span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>actions<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> f<span class="token punctuation">.</span>submit <span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%</span> <span class="token keyword">end</span> <span class="token delimiter punctuation">%&gt;</span></span>
</code></pre></div><h3 id="_2-like-other-fields-we-must-allow-it-in-strong-parameters"><a href="#_2-like-other-fields-we-must-allow-it-in-strong-parameters" class="header-anchor">#</a> 2. Like other fields, we must allow it in strong parameters</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># app/controllers/products_controller.rb</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">product_params</span></span>
  params<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token symbol">:product</span><span class="token punctuation">)</span><span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">,</span> <span class="token symbol">:image</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>Now we can send and save an image using the form:
<img src="/assets/img/optimised.a200c040.gif" alt="Image upload on browser"></p> <h2 id="performance-with-cache"><a href="#performance-with-cache" class="header-anchor">#</a> Performance with cache</h2> <p>As DragonFly gem generates new versions on the fly, it can be very resource-consuming, so we need to use a server cache solution.</p> <p>Let's add the <code>rack-cache gem</code>.</p> <h3 id="_1-add-it-to-gemfile"><a href="#_1-add-it-to-gemfile" class="header-anchor">#</a> 1. Add it to <code>Gemfile</code></h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># Gemfile</span>
gem <span class="token string">'rack-cache'</span><span class="token punctuation">,</span> <span class="token keyword">require</span><span class="token punctuation">:</span> <span class="token string">'rack/cache'</span><span class="token punctuation">,</span> group<span class="token punctuation">:</span> <span class="token symbol">:production</span>
</code></pre></div><h3 id="_2-install-it-2"><a href="#_2-install-it-2" class="header-anchor">#</a> 2. Install it</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>bundle <span class="token function">install</span>
</code></pre></div><h3 id="_3-enable-it-on-production"><a href="#_3-enable-it-on-production" class="header-anchor">#</a> 3. Enable it on production</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># config/environments/production.rb</span>
config<span class="token punctuation">.</span>action_dispatch<span class="token punctuation">.</span>rack_cache <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre></div><h3 id="_4-set-the-cache-s-temporary-folder"><a href="#_4-set-the-cache-s-temporary-folder" class="header-anchor">#</a> 4. Set the cache's temporary folder</h3> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># config/application.rb</span>
<span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token operator">&lt;</span> <span class="token constant">Rails</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Application</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">if</span> <span class="token keyword">defined</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token constant">Rack</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Cache</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>middleware<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token constant">Rack</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Cache</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>middleware<span class="token punctuation">.</span>insert <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">Rack</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Cache</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token symbol">:verbose</span>     <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment"># log verbosity</span>
      <span class="token symbol">:metastore</span>   <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">URI</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;file:<span class="token interpolation"><span class="token delimiter tag">#{</span><span class="token constant">Rails</span><span class="token punctuation">.</span>root<span class="token delimiter tag">}</span></span>/tmp/dragonfly/cache/meta&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># URI encoded in case of spaces</span>
      <span class="token symbol">:entitystore</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">URI</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&quot;file:<span class="token interpolation"><span class="token delimiter tag">#{</span><span class="token constant">Rails</span><span class="token punctuation">.</span>root<span class="token delimiter tag">}</span></span>/tmp/dragonfly/cache/body&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You don't need to do this if you already use a server cache solution like <strong>Varnish</strong>.</p></div> <h2 id="validation"><a href="#validation" class="header-anchor">#</a> Validation</h2> <p>Use <code>validates_property</code> method on the model to validate properties. Examples:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># app/models/product.rb</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>
  dragonfly_accessor <span class="token symbol">:image</span>

  validates_property <span class="token symbol">:width</span><span class="token punctuation">,</span> of<span class="token punctuation">:</span> <span class="token symbol">:image</span><span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0.</span><span class="token number">.400</span><span class="token punctuation">)</span>
  validates_property <span class="token symbol">:mime_type</span><span class="token punctuation">,</span> of<span class="token punctuation">:</span> <span class="token symbol">:image</span><span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token string">%w(image/jpeg image/png)</span>
  validates_property <span class="token symbol">:size</span><span class="token punctuation">,</span> of<span class="token punctuation">:</span> <span class="token symbol">:image</span><span class="token punctuation">,</span> maximum<span class="token punctuation">:</span> <span class="token number">500.</span>kilobytes
<span class="token keyword">end</span>
</code></pre></div><p>As an example, let's say you want to validate if the attachment is an image or something else. With this you can make sure your users aren't uploading movies or applications:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token comment"># app/models/product.rb</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">Base</span>
  dragonfly_accessor <span class="token symbol">:image</span>

  validates_property <span class="token symbol">:mime_type</span><span class="token punctuation">,</span> of<span class="token punctuation">:</span> <span class="token symbol">:image</span><span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token string">%w(image)</span>
<span class="token keyword">end</span>
</code></pre></div><p>See a full list of validations here:
<a href="https://markevans.github.io/dragonfly/models#validations" target="_blank" rel="noopener noreferrer">https://markevans.github.io/dragonfly/models#validations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="s3-dropbox-watermarks-and-more"><a href="#s3-dropbox-watermarks-and-more" class="header-anchor">#</a> S3, Dropbox, Watermarks and More</h2> <p>This concludes our basic DragonFly gem tutorial, but DragonFly has also many advanced features: you can use Amazon S3, Dropbox, and other providers as your storage. You can change the image on-the-fly in so many ways: add a watermark, change to black and white, change the file format, and so on. You can also create your own plugins to extend DragonFly.</p> <p>You can also work with other binary types like movies or apps, but I won't cover these things here. Maybe on other tutorial 😉</p> <h2 id="common-problems"><a href="#common-problems" class="header-anchor">#</a> Common problems</h2> <ul><li><strong>&quot;404 - Not Found:</strong> If you get this error, you probably don't have <code>ImageMagick</code> installed. On Ubuntu, run a <code>sudo apt-get install imagemagick</code> to fix it.</li></ul> <h2 id="more-info"><a href="#more-info" class="header-anchor">#</a> More info</h2> <ul><li><strong>DragonFly gem:</strong> <a href="https://markevans.github.io/dragonfly/" target="_blank" rel="noopener noreferrer">https://markevans.github.io/dragonfly/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>On GitHub:</strong> <a href="https://github.com/markevans/dragonfly" target="_blank" rel="noopener noreferrer">https://github.com/markevans/dragonfly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>DragonFly author:</strong> Mark Evans</li></ul></div></div> <hr class="my-12" data-v-335698aa> <div data-v-335698aa><h2 class="text-xl md:text-3xl pb-10 text-center" data-v-335698aa>Comments</h2> <!----></div></div> <footer class="py-4 bg-gray-800" data-v-335698aa><p class="text-center text-gray-600 text-xs">Copyright 2022 - Daniel Loureiro</p></footer></div><div class="global-ui"><!----><!----><!----></div></div>
    <script src="/assets/js/app.5632ea00.js" defer></script><script src="/assets/js/3.9e1cc85f.js" defer></script><script src="/assets/js/17.6ade2139.js" defer></script><script src="/assets/js/22.2ffb8c95.js" defer></script>
  </body>
</html>
