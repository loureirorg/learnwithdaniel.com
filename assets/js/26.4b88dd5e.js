(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{458:function(s,t,a){s.exports=a.p+"assets/img/gmail-alert.c3d154fd.png"},459:function(s,t,a){s.exports=a.p+"assets/img/gmail-allow-less.f21b4baa.png"},540:function(s,t,a){"use strict";a.r(t);var e=a(21),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("Let's create a Gmail email client using PHP's native IMAP library.\n")]),s._v(" "),e("p",[s._v("For this, you need the "),e("code",[s._v("php-imap")]),s._v(" installed.")]),s._v(" "),e("p",[s._v("Despite the name, the IMAP library works with POP3 too.")]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"basic-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-code"}},[s._v("#")]),s._v(" Basic code")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// gmail-client.php")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Connect to GMail. */")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'daniel@gmail.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'34LWD12'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$str_conn")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'{imap.gmail.com:993/ssl/novalidate-cert}INBOX'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$str_conn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** Retrieve and display all messages. */")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$msgs")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_fetch_overview")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'1:*'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("print_r")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$msgs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("h2",{attrs:{id:"return-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#return-example"}},[s._v("#")]),s._v(" Return Example")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Array")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" stdClass "),e("span",{pre:!0,attrs:{class:"token keyword type-declaration"}},[s._v("Object")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("subject"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Test\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("from"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" John Snow "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("john@snow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Daniel Loureiro "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("daniel@learnwithdaniel"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("date"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Fri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" Jul "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0400")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("message_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CABgjj39"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("BMb_NPaCPmh"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ds7zsOzTCrJfRotaB4CZ1Yuv"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mLxkA@mail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("gmail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("size"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4691")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("uid"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msgno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("recent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flagged"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("answered"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("deleted"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("seen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("draft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("udate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1562951089")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),e("div",{staticClass:"custom-block success"},[e("p",[s._v("That's it!")])]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"pop3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pop3"}},[s._v("#")]),s._v(" POP3")]),s._v(" "),e("p",[s._v("The previous example connects through IMAP. If you prefer POP3, use this:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$str_conn")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'{pop.gmail.com:995/pop3/ssl/novalidate-cert}INBOX'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("hr"),s._v(" "),e("h3",{attrs:{id:"credentials"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#credentials"}},[s._v("#")]),s._v(" Credentials")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Username:")]),s._v(' Your email.\nEx: "'),e("em",[s._v("daniel@gmail.com")]),s._v('". It can have a '),e("strong",[s._v("custom domain")]),s._v(', like "'),e("em",[s._v("daniel@learwithdaniel.com")]),s._v('".')]),s._v(" "),e("li",[e("strong",[s._v("Password:")]),s._v(' Your account password.\nFor 2-step verification accounts, you can use an "'),e("em",[e("strong",[s._v("app password")])]),s._v('". These are extra passwords to access your account. With them, you don\'t need to share your actual password with your apps. For each app, you create a new "app password". This is only available if "2-step" is enabled.')])]),s._v(" "),e("h3",{attrs:{id:"msgno"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#msgno"}},[s._v("#")]),s._v(" "),e("code",[s._v("msgno")])]),s._v(" "),e("p",[s._v("Each message has a "),e("code",[s._v("msgno")]),s._v(", which is a sequential number. The very first message is "),e("code",[s._v("1")]),s._v(". This number is unique for your mailbox. Even if you delete a message, its "),e("code",[s._v("msgno")]),s._v(" won't be reused.")]),s._v(" "),e("p",[s._v("The "),e("code",[s._v("msgno")]),s._v(" is used in many commands.")]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"troubleshooting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[s._v("#")]),s._v(" Troubleshooting")]),s._v(" "),e("p",[s._v('If you get an "invalid credentials" error, you may have to enable the "Allow Less Secure Apps" option: '),e("a",{attrs:{href:"https://myaccount.google.com/lesssecureapps",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://myaccount.google.com/lesssecureapps"),e("OutboundLink")],1)]),s._v(" "),e("ol",[e("li",[e("p",[s._v("If you get this email, you need to click on it and authorize access:\n"),e("img",{attrs:{src:a(458),alt:"Gmail blocked access"}})])]),s._v(" "),e("li",[e("p",[s._v('Then, enable "Less Secure Apps" (or just use an "app password"):\n'),e("img",{attrs:{src:a(459),alt:"Gmail less secure apps option"}})])])]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"retrieving-emails"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retrieving-emails"}},[s._v("#")]),s._v(" Retrieving emails")]),s._v(" "),e("p",[s._v("As we saw previously, that's how we get the messages:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// gmail-client.php")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$msgs")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_fetch_overview")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$range")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[e("code",[s._v("$range")]),s._v(" format is: "),e("code",[s._v("{msgno_from}:{msgno_to}")]),s._v(". The "),e("code",[s._v("msgno_from")]),s._v(" and "),e("code",[s._v("msgno_to")]),s._v(" are included in the response.")]),s._v(" "),e("p",[e("strong",[s._v("Range examples:")])]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("All messages:")]),s._v(" '1:*'")]),s._v(" "),e("li",[e("strong",[s._v("Just message #3:")]),s._v(" '3'")]),s._v(" "),e("li",[e("strong",[s._v("Message #3 and beyond (3,4,5,…):")]),s._v(" '3:*';")])]),s._v(" "),e("p",[s._v("Use the range argument to create savepoints, i.e. if you want to download "),e("strong",[s._v("only the new messages")]),s._v(" and not the whole inbox each time your app syncs with Gmail. To create savepoints, download all messages ("),e("code",[s._v("1:*")]),s._v(') on the first time and save the last message number ("msgno"), ex. '),e("code",[s._v("5")]),s._v(". Next time, you check from that message and beyond ("),e("code",[s._v("6:*")]),s._v(").")]),s._v(" "),e("h2",{attrs:{id:"display-name-from-to"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#display-name-from-to"}},[s._v("#")]),s._v(" Display Name (From/To)")]),s._v(" "),e("p",[s._v('The "From" and "To" fields support a display name in addition to the email address:')]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Email address only:")]),s._v(" "),e("code",[s._v("john@snow.com")])]),s._v(" "),e("li",[e("strong",[s._v("Email address with Display name:")]),s._v(" "),e("code",[s._v("John Snow <john@snow.com>")])])]),s._v(" "),e("h2",{attrs:{id:"closing-the-connection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#closing-the-connection"}},[s._v("#")]),s._v(" Closing the connection")]),s._v(" "),e("p",[s._v("You should close the email connection after using it, which is usually at the end of your script.")]),s._v(" "),e("p",[s._v("If you forget to close, PHP will automatically close it for you when the script ends, but it is a good idea to explicitly close it with:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_close")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$conn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("h2",{attrs:{id:"errors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#errors"}},[s._v("#")]),s._v(" Errors")]),s._v(" "),e("p",[s._v("To get an array with past errors, use:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errors")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_errors")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("p",[s._v("Return example:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'[TRYCREATE] No folder {imap.gmail.com} (Failure)'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),e("p",[s._v("To get only the last error, use "),e("code",[s._v("imap_last_error()")]),s._v(".")]),s._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),e("p",[s._v("If you don't retrieve errors by calling these functions, then all errors and warnings will be thrown when the connection gets closed.")])]),s._v(" "),e("h2",{attrs:{id:"replying-to-an-email"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#replying-to-an-email"}},[s._v("#")]),s._v(" Replying to an email")]),s._v(" "),e("p",[s._v("Each message has a "),e("code",[s._v("message_id")]),s._v(", which is a universal unique identifier. Do not confuse with "),e("code",[s._v("msgno")]),s._v(", which is a local id, valid only for your inbox.")]),s._v(" "),e("p",[s._v("To reply to messages, you need to set 2 things:")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Headers:")]),s._v(" Send the "),e("code",[s._v("message_id")]),s._v(" of the message you are replying to in two header items: "),e("code",[s._v("In-Reply-To")]),s._v(" and "),e("code",[s._v("References")]),s._v(";")]),s._v(" "),e("li",[e("strong",[s._v("Subject:")]),s._v(" The subject should be postfixed with the same subject as the original message. Example of valid reply subjects: "),e("code",[s._v("{$subject}")]),s._v(" or "),e("code",[s._v("Re: {$subject}")]),s._v(" or "),e("code",[s._v("Reply to {$subject}")]),s._v('. It actually doesn\'t matter if you prefix with something (like "Re:") or not, the only rule is that you need to end the subject with the original copy;')])]),s._v(" "),e("h2",{attrs:{id:"example-of-a-replied-message"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-of-a-replied-message"}},[s._v("#")]),s._v(" Example of a replied message")]),s._v(" "),e("p",[s._v("If you are curious of how a replied message looks like when retrieving it:")]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" stdClass "),e("span",{pre:!0,attrs:{class:"token keyword type-declaration"}},[s._v("Object")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("subject"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token argument-name"}},[s._v("Re")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Test\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("from"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" john@snow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Daniel Loureiro "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("daniel@learnwithdaniel"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("date"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" Fri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" Jul "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0400")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("message_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("A0C26432")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DD82")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("411")]),s._v("A"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AD61")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("FB12E65C4D1@learnwithdaniel"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("references"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CABgjj39"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("BMb_NPaCPmh"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ds7zsOzTCrJfRotaB4CZ1Yuv"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mLxkA@mail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("gmail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("in_reply_to"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CABgjj39"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("BMb_NPaCPmh"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ds7zsOzTCrJfRotaB4CZ1Yuv"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mLxkA@mail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("gmail"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("size"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4691")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("uid"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msgno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("recent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flagged"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("answered"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("deleted"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("seen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("draft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("udate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1562951089")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),e("p",[s._v("Notice "),e("code",[s._v("subject")]),s._v(", "),e("code",[s._v("references")]),s._v(" and the "),e("code",[s._v("in_reply_to")]),s._v(" fields.")]),s._v(" "),e("h2",{attrs:{id:"which-email-address-you-should-reply-to"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#which-email-address-you-should-reply-to"}},[s._v("#")]),s._v(" Which email address you should reply to?")]),s._v(" "),e("p",[s._v('You can reply to the email address specified in the "From" field, but if the sender has set a "reply-to", your message will go the '),e("strong",[s._v("wrong place")]),s._v(".")]),s._v(" "),e("p",[s._v("To reply properly, you should get the headers with "),e("code",[s._v("imap_headerinfo($hnd, $msgno)")]),s._v(" and use the "),e("code",[s._v("reply_toaddress")]),s._v(" property (a string). Alternatively, you can use the "),e("code",[s._v("reply_to")]),s._v(" property, which returns the email parsed as domain, account and display_name.")]),s._v(" "),e("p",[s._v('It is safe to always use the "reply_toaddress" property (or the "reply_to") even if the sender hasn\'t set a reply-to. In these cases, "reply_toaddress" will return the same value as "from".')]),s._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$headers")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("imap_headerinfo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hnd")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$msgno")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$reply_addr")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$headers")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[s._v("reply_toaddress")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);