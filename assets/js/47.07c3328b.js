(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{513:function(a,s,t){"use strict";t.r(s);var e=t(21),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("Let's see how to compile ruby scripts into standalone binaries.\n")]),a._v(" "),t("h2",{attrs:{id:"this-method-works-with"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#this-method-works-with"}},[a._v("#")]),a._v(" This method works with")]),a._v(" "),t("ul",[t("li",[a._v("Rails apps (your executable file will be a portable webserver);")]),a._v(" "),t("li",[a._v("Scripts with gems;")]),a._v(" "),t("li",[a._v("Simple, single-source file scripts;")]),a._v(" "),t("li",[a._v("Multiple source file scripts;")])]),a._v(" "),t("p",[a._v("The final app will be a single executable file that can run on systems without a ruby interpreter installed.")]),a._v(" "),t("hr"),a._v(" "),t("h2",{attrs:{id:"update"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[a._v("#")]),a._v(" UPDATE")]),a._v(" "),t("p",[t("strong",[a._v("I developed a gem to automate this process.")]),a._v(" Check it out:\n"),t("a",{attrs:{href:"https://github.com/loureirorg/rb2exe",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/loureirorg/rb2exe"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"usage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[a._v("#")]),a._v(" Usage")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("gem "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" rb2exe\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"puts 'Hello world'\"")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" test.rb\n\nrb2exe test.rb\n./test\n    Hello world\n")])])]),t("hr"),a._v(" "),t("h2",{attrs:{id:"how-this-works-step-by-step"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-this-works-step-by-step"}},[a._v("#")]),a._v(" How this works, step-by-step")]),a._v(" "),t("h3",{attrs:{id:"first-let-s-create-a-hello-world-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#first-let-s-create-a-hello-world-app"}},[a._v("#")]),a._v(" First, let's create a Hello World app")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" hello\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" hello\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"puts 'Hello world'\"")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" test.rb\nruby test.rb\n    Hello world\n")])])]),t("p",[a._v("This method uses "),t("strong",[a._v("Ruby Traveler")]),a._v(" and pack everything into a self-extract file.")]),a._v(" "),t("p",[a._v('Ruby Traveler is just a static folder with a standalone "ruby" executable. The plan here is to add Ruby Traveler\'s folder and binaries to our project and compress everything into a single self-extractable zip file. This self-extractable file will extract the compressed data into a temporary folder and execute the main ruby script (ex. '),t("code",[a._v("test.rb")]),a._v(").")]),a._v(" "),t("p",[a._v("As this is based on Ruby Traveler (by Phusion), which seems to be a stalled project, we are locked to the only versions they support â€“ the latest one is 2.2.2. ðŸ˜¦")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("If you want to use different Ruby versions, "),t("strong",[a._v("other than 2.2.2")]),a._v(", I recommend adapting this script to zw693's Traveling Ruby, which supports "),t("strong",[a._v("ALL Ruby versions")]),a._v(":\n"),t("a",{attrs:{href:"https://github.com/zw963/traveling-ruby",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/zw963/traveling-ruby"),t("OutboundLink")],1)])]),a._v(" "),t("hr"),a._v(" "),t("h2",{attrs:{id:"part-i-standalone-ruby"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#part-i-standalone-ruby"}},[a._v("#")]),a._v(" Part I: Standalone Ruby")]),a._v(" "),t("h3",{attrs:{id:"your-ruby-version-should-be-2-2-2-64-bits"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#your-ruby-version-should-be-2-2-2-64-bits"}},[a._v("#")]),a._v(" Your ruby version should be "),t("code",[a._v("2.2.2")]),a._v(", 64 bits")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$RUBY_VERSION")]),a._v("\nruby-2.2.2\n")])])]),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),t("p",[a._v("If your version is different, please install the 2.2.2 (e.g. "),t("code",[a._v("rvm use 2.2.2")]),a._v(").\n"),t("strong",[a._v("This will NOT work with 2.2.0, 2.2.3, 2.1, etc.")])])]),a._v(" "),t("h3",{attrs:{id:"duplicate-the-project-folder-naming-it-as-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#duplicate-the-project-folder-naming-it-as-app"}},[a._v("#")]),a._v(' Duplicate the project folder, naming it as "app"')]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" -r -pa hello app\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" hello\n")])])]),t("h3",{attrs:{id:"in-the-project-folder-create-a-package-payload-lib-ruby-sub-folder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#in-the-project-folder-create-a-package-payload-lib-ruby-sub-folder"}},[a._v("#")]),a._v(" In the project folder, create a "),t("code",[a._v(".package/payload/lib/ruby")]),a._v(" sub-folder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p .package/payload/lib/ruby\n")])])]),t("h3",{attrs:{id:"move-the-app-folder-to-package-payload-lib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#move-the-app-folder-to-package-payload-lib"}},[a._v("#")]),a._v(' Move the "app" folder to '),t("code",[a._v(".package/payload/lib")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/app .package/payload/lib\ntree -a\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n    â”œâ”€â”€ .package\n    â”‚   â””â”€â”€ payload\n    â”‚       â””â”€â”€ lib\n    â”‚           â”œâ”€â”€ app\n    â”‚           â”‚   â””â”€â”€ test.rb\n    â”‚           â””â”€â”€ ruby\n    â””â”€â”€ test.rb\n")])])]),t("h3",{attrs:{id:"download-ruby-traveler-2-2-2-64-bits-5-6m-and-unzip-it-on-package-payload-lib-ruby"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#download-ruby-traveler-2-2-2-64-bits-5-6m-and-unzip-it-on-package-payload-lib-ruby"}},[a._v("#")]),a._v(" Download ruby traveler 2.2.2 64 bits (5.6M), and unzip it on "),t("code",[a._v(".package/payload/lib/ruby")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" .package/payload/lib/ruby\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/ruby/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://d6r77u77i8pq3.cloudfront.net/releases/traveling-ruby-20150715-2.2.2-linux-x86_64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -xf traveling-ruby-20150715-2.2.2-linux-x86_64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" traveling-ruby-20150715-2.2.2-linux-x86_64.tar.gz\n")])])]),t("h3",{attrs:{id:"go-back-to-package-payload"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-back-to-package-payload"}},[a._v("#")]),a._v(" Go back to "),t("code",[a._v(".package/payload/")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/ruby/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),a._v("\n    ~/hello/.package/payload\n")])])]),t("h3",{attrs:{id:"create-a-wrapper-script-name-it-as-installer-sh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-a-wrapper-script-name-it-as-installer-sh"}},[a._v("#")]),a._v(" Create a wrapper script (name it as "),t("code",[a._v("installer.sh")]),a._v(")")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" installer.sh\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/bash")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" -e\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Figure out where this script is located.")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SELFDIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("dirname")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v('"$0'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v('"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SELFDIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v('"$SELFDIR'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v('" '),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v('"')]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## GEMFILE")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" -f "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/vendor/Gemfile"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Tell Bundler where the Gemfile and gems are.")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BUNDLE_GEMFILE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/vendor/Gemfile"')]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("unset")]),a._v(" BUNDLE_IGNORE_CONFIG\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Run the actual app using the bundled Ruby interpreter, with Bundler activated.")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/ruby/bin/ruby"')]),a._v(" -rbundler/setup "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/app/test.rb"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/ruby/bin/ruby"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$SELFDIR")]),a._v('/lib/app/test.rb"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x installer.sh\n")])])]),t("p",[a._v("Replace the "),t("code",[a._v("exec")]),a._v(" lines with your actual command to start the application. Eg. for Rails apps, it should be:\n"),t("code",[a._v('RAILS_ENV=production exec "$SELFDIR/lib/ruby/bin/ruby" -rbundler/setup "$SELFDIR/lib/app/bin/rails" server')])]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v('The previous script is based on the "traveling ruby" tutorial. If you want to understand this process better, you can follow the official "traveling ruby" instructions.')])]),a._v(" "),t("hr"),a._v(" "),t("h2",{attrs:{id:"part-ii-gemfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#part-ii-gemfile"}},[a._v("#")]),a._v(" Part II: Gemfile")]),a._v(" "),t("p",[a._v("If your project has a Gemfile, you need to follow these extra steps:")]),a._v(" "),t("h3",{attrs:{id:"create-a-tmp-folder-on-package-payload-lib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-a-tmp-folder-on-package-payload-lib"}},[a._v("#")]),a._v(" Create a "),t("code",[a._v("tmp")]),a._v(" folder on "),t("code",[a._v(".package/payload/lib")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" lib\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" tmp\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" tmp\n")])])]),t("h3",{attrs:{id:"copy-the-gemfile-to-tmp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#copy-the-gemfile-to-tmp"}},[a._v("#")]),a._v(" Copy the "),t("code",[a._v("Gemfile")]),a._v(" to "),t("code",[a._v("tmp")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/tmp/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/app/Gemfile* "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),t("h3",{attrs:{id:"download-gems-into-the-lib-vendor-folder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#download-gems-into-the-lib-vendor-folder"}},[a._v("#")]),a._v(" Download gems into the "),t("code",[a._v("lib/vendor")]),a._v(" folder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/tmp/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("BUNDLE_IGNORE_CONFIG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" bundle "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" --path "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/vendor --without development\n")])])]),t("h3",{attrs:{id:"delete-tmp-folder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#delete-tmp-folder"}},[a._v("#")]),a._v(" Delete "),t("code",[a._v("tmp")]),a._v(" folder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/tmp/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -Rf tmp\n")])])]),t("h3",{attrs:{id:"optional-delete-gem-s-cache-in-the-vendor-folder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#optional-delete-gem-s-cache-in-the-vendor-folder"}},[a._v("#")]),a._v(" [Optional] Delete gem's cache in the "),t("code",[a._v("vendor")]),a._v(" folder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -f vendor/*/*/cache/*\n")])])]),t("h3",{attrs:{id:"copy-the-gemfile-to-the-vendor-folder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#copy-the-gemfile-to-the-vendor-folder"}},[a._v("#")]),a._v(" Copy the "),t("code",[a._v("Gemfile")]),a._v(" to the "),t("code",[a._v("vendor")]),a._v(" folder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" app/Gemfile* vendor/\n")])])]),t("h3",{attrs:{id:"create-a-bundler-config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-a-bundler-config"}},[a._v("#")]),a._v(" Create a bundler config")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" vendor/.bundle/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" vendor/.bundle/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/payload/lib/vendor/.bundle/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" config\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("BUNDLE_PATH: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\nBUNDLE_WITHOUT: development\nBUNDLE_DISABLE_SHARED_GEMS: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'1'")]),a._v("\n")])])]),t("hr"),a._v(" "),t("h2",{attrs:{id:"part-iii-pack-everything-as-a-single-self-extract-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#part-iii-pack-everything-as-a-single-self-extract-file"}},[a._v("#")]),a._v(" Part III: Pack everything as a single self-extract file")]),a._v(" "),t("p",[a._v("This part is based on "),t("a",{attrs:{href:"https://www.linuxjournal.com/node/1005818",target:"_blank",rel:"noopener noreferrer"}},[a._v("Jeff Parent's article"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("h3",{attrs:{id:"create-a-script-to-decompress-everything"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-a-script-to-decompress-everything"}},[a._v("#")]),a._v(" Create a script to decompress everything")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" decompress.sh\n")])])]),t("p",[a._v("The "),t("code",[a._v(".package/decompress.sh")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/bash")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TMPDIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("mktemp -d /tmp/selfextract.XXXXXX"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ARCHIVE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("awk")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'/^__ARCHIVE_BELOW__/ {print NR + 1; exit 0; }'")]),a._v(" $0"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -n+"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$ARCHIVE")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -xz -C "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TMPDIR")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CDIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TMPDIR")]),a._v("\n./installer.sh\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$CDIR")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -rf "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TMPDIR")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n\n__ARCHIVE_BELOW__\n")])])]),t("h3",{attrs:{id:"package-builder"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#package-builder"}},[a._v("#")]),a._v(" Package builder")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" build.sh\n")])])]),t("p",[a._v("The "),t("code",[a._v(".package/build.sh")]),a._v(":")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/bash")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" payload\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" cf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/payload.tar ./*\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"payload.tar"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("gzip")]),a._v(" payload.tar\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"payload.tar.gz"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" decompress.sh payload.tar.gz "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" output.sh\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"payload.tar.gz does not exist"')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"payload.tar does not exist"')]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x output.sh\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Self-extract file created"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ~/hello/.package/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x decompress.sh\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x build.sh\n./build.sh\n    Self-extract "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" created\n")])])]),t("div",{staticClass:"custom-block success"},[t("p",[a._v('And that\'s it. You can now rename and distribute the generated "output.sh" file ðŸ˜ƒ')])])])}),[],!1,null,null,null);s.default=r.exports}}]);